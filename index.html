<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Secure Curves in the Web Cryptography API</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
  <script class='remove'>
  "use strict";
  // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
  var respecConfig = {
    "github": "WICG/webcrypto-secure-curves",
    "editors": [
      {
        name: "Daniel Huigens",
        url: "mailto:daniel.huigens@proton.ch",
        company: "Proton AG",
        companyURL: "https://proton.me/",
      },
    ],
    "shortName": "webcrypto-secure-curves",
    "specStatus": "CG-DRAFT",
    "group": "wicg",
    "xref": ["WebIDL", "WebCryptoAPI"],
    "localBiblio": {
      "SafeCurves": {
        "title": "Daniel J. Bernstein and Tanja Lange. SafeCurves: choosing safe curves for elliptic-curve cryptography",
        "href": "https://safecurves.cr.yp.to/",
      }
    },
  };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      This specification defines a number of algorithms for the [[[WebCryptoAPI]]],
      namely X25519 and X448 [[RFC7748]], and Ed25519 and Ed448 [[RFC8032]].
    </p>
  </section>
  <section id="sotd">
    <p>
      This is an unofficial proposal.
    </p>
  </section>
  <section id="introduction" class="informative">
    <h2>Introduction</h2>
    <p>
      The [[[WebCryptoAPI]]] currently does not specify any "safe curves" [[SafeCurves]].
      Among the safe curves, Curve25519 and Curve448 have gained the most traction, and
      have been specified for use in TLS 1.3, among others. This specification aims to
      expose these algorithms to the web platform.
      To this end, this specification defines a number of algorithms and operations for
      the [[[WebCryptoAPI]]], namely key agreement using X25519 and X448 [[RFC7748]], and
      signing and verifying using Ed25519 and Ed448 [[RFC8032]].
    </p>
  </section>
  <section id="specification-conventions">
    <h2>Specification Conventions</h3>
    <p>
      This specification follows the <a data-cite="WebCryptoAPI#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [[WebCryptoAPI]]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it MUST implement all of the supported operations specified in this
      document, and must perform the steps to <a data-cite="WebCryptoAPI#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [[WebCryptoAPI]] for each of the supported operations.
    </p>
  </section>

  <section id="x25519">
    <h3>X25519</h3>
    <section id="x25519-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`X25519`" algorithm identifier is used to perform
        key agreement using the X25519 algorithm specified in
        [[RFC7748]].
      </p>
    </section>
    <section id="x25519-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "`X25519`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td>{{EcdhKeyDeriveParams}}</td>
            <td><a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="x25519-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be the
                {{EcdhKeyDeriveParams/public}} member of
                |normalizedAlgorithm|.
              </p>
            </li>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{KeyAlgorithm/name}} attribute of
                the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal slot of
                |publicKey| is not equal to the {{KeyAlgorithm/name}} property of the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal slot of
                |key|, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |secret| be the result of performing the X25519 function specified in
                [[RFC7748]] Section 5 with |key| as the X25519 private key |k|
                and the X25519 public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |publicKey| as the X25519 public key |u|.
              </p>
            </li>
            <li>
              <p>
                If |secret| is the all-zero value,
                then [= exception/throw =] a {{OperationError}}.
                This check must be performed in constant-time, as per [[RFC7748]] Section 6.1.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |length| is null:</dt>
                <dd>Return |secret|</dd>
                <dt>Otherwise:</dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the length of |secret| in bits is less than
                      |length|:
                    </dt>
                    <dd>
                      [= exception/throw =] an
                      {{OperationError}}.
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      Return an <a data-cite="WebCryptoAPI#octet-string-containing">octet string containing</a> the first |length| bits of |secret|.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains an entry which is not
                "`deriveKey`" or "`deriveBits`"
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                Generate an X25519 key pair, with the private key being 32 random bytes,
                and the public key being `X25519(a, 9)`,
                as defined in [[RFC7748]], section 6.1.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new {{KeyAlgorithm}} object.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`X25519`".
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| to "`public`"
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |publicKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |publicKey| to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |publicKey| to be the empty list.
              </p>
            </li>
            <li>
              <p>
                Let |privateKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |privateKey| to {{KeyType/"private"}}
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |privateKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |privateKey| to |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |privateKey| to be the
                <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a> of
                |usages| and `[ "deriveKey", "deriveBits" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a new {{CryptoKeyPair}}
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/publicKey}} attribute
                of |result| to be |publicKey|.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/privateKey}} attribute
                of |result| to be |privateKey|.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting |result| to an ECMAScript Object, as
                defined by [[WebIDL]].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let |keyData| be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| is not empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |spki| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `algorithm` AlgorithmIdentifier field of |spki| is
                        not equal to the `id-X25519`
                        object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the `algorithm`
                        AlgorithmIdentifier field of |spki| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |publicKey| be the X25519 public key identified by
                        the `subjectPublicKey` field of |spki|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents |publicKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains an entry which is not
                        "`deriveKey`" or "`deriveBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |privateKeyInfo| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                        |privateKeyInfo| is not equal to the
                        `id-X25519` object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                        of |privateKeyInfo| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |curvePrivateKey| be the result of performing the <a data-cite="WebCryptoAPI#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with |data| as the `privateKey` field
                        of |privateKeyInfo|, |structure| as the ASN.1
                        `CurvePrivateKey` structure specified in Section 7 of [[RFC8410]], and |exactData| set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents the X25519 private key identified by |curvePrivateKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to {{KeyType/"private"}}
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is present and if |usages|
                        contains an entry which is not
                        "`deriveKey`" or "`deriveBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is not present and if |usages| is not
                        empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`OKP`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/crv}} field of |jwk| is not
                        "`X25519`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present
                        and is not equal to "`enc`" then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of JSON Web
                        Key [[JWK]], or it does not contain all of the specified |usages|
                        values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the {{JsonWebKey/d}} field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                X25519 private key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"private"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                X25519 public key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"public"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| is not empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        representing the key data provided in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |key|
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |key| be the {{CryptoKey}} to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `subjectPublicKeyInfo`
                        ASN.1 structure defined in [[RFC5280]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |algorithm| field to an
                            `AlgorithmIdentifier` ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-X25519` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |subjectPublicKey| field to |keyData|.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `privateKeyInfo`
                        ASN.1 structure defined in [[RFC5208]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |version| field to `0`.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the |privateKeyAlgorithm| field to a
                            `PrivateKeyAlgorithmIdentifier` ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-X25519` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |privateKey| field to the result of DER-encoding
                            a `CurvePrivateKey` ASN.1 type, as defined in Section 7 of [[RFC8410]], that represents the
                            X25519 private key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                            |key|
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to
                        "`OKP`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `crv` attribute of |jwk| to
                        "`X25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/x}} attribute of |jwk| according to the
                        definition in Section 2 of [[RFC8037]].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                          of |key| is {{KeyType/"private"}}
                        </dt>
                        <dd>
                          Set the {{JsonWebKey/d}} attribute of |jwk| according to the
                          definition in Section 2 of [[RFC8037]].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If |format| is {{KeyFormat/"raw"}}:
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an <a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a> representing the X25519
                        public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="x448">
    <h3>X448</h3>
    <section id="x448-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`X448`" algorithm identifier is used to perform
        key agreement using the X448 algorithm specified in
        [[RFC7748]].
      </p>
    </section>
    <section id="x448-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "`X448`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td>{{EcdhKeyDeriveParams}}</td>
            <td><a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="x448-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be the
                {{EcdhKeyDeriveParams/public}} member of
                |normalizedAlgorithm|.
              </p>
            </li>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{KeyAlgorithm/name}} attribute of
                the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal slot of
                |publicKey| is not equal to the {{KeyAlgorithm/name}} property of the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal slot of
                |key|, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |secret| be the result of performing the X448 function specified in
                [[RFC7748]] Section 5 with |key| as the X448 private key |k|
                and the X448 public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |publicKey| as the X448 public key |u|.
              </p>
            </li>
            <li>
              <p>
                If |secret| is the all-zero value,
                then [= exception/throw =] a {{OperationError}}.
                This check must be performed in constant-time, as per [[RFC7748]] Section 6.2.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |length| is null:</dt>
                <dd>Return |secret|</dd>
                <dt>Otherwise:</dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the length of |secret| in bits is less than
                      |length|:
                    </dt>
                    <dd>
                      [= exception/throw =] an
                      {{OperationError}}.
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      Return an <a data-cite="WebCryptoAPI#octet-string-containing">octet string containing</a> the first |length| bits of |secret|.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains an entry which is not
                "`deriveKey`" or "`deriveBits`"
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                Generate an X448 key pair, with the private key being 56 random bytes,
                and the public key being `X448(a, 5)`,
                as defined in [[RFC7748]], section 6.2.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new {{KeyAlgorithm}} object.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`X448`".
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| to "`public`"
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |publicKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |publicKey| to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |publicKey| to be the empty list.
              </p>
            </li>
            <li>
              <p>
                Let |privateKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |privateKey| to {{KeyType/"private"}}
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |privateKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |privateKey| to |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |privateKey| to be the
                <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a> of
                |usages| and `[ "deriveKey", "deriveBits" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a new {{CryptoKeyPair}}
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/publicKey}} attribute
                of |result| to be |publicKey|.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/privateKey}} attribute
                of |result| to be |privateKey|.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting |result| to an ECMAScript Object, as
                defined by [[WebIDL]].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let |keyData| be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| is not empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |spki| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `algorithm` AlgorithmIdentifier field of |spki| is
                        not equal to the `id-X448`
                        object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the `algorithm`
                        AlgorithmIdentifier field of |spki| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |publicKey| be the X448 public key identified by
                        the `subjectPublicKey` field of |spki|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents |publicKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains an entry which is not
                        "`deriveKey`" or "`deriveBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |privateKeyInfo| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                        |privateKeyInfo| is not equal to the
                        `id-X448` object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                        of |privateKeyInfo| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |curvePrivateKey| be the result of performing the <a data-cite="WebCryptoAPI#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with |data| as the `privateKey` field
                        of |privateKeyInfo|, |structure| as the ASN.1
                        `CurvePrivateKey` structure specified in Section 7 of [[RFC8410]], and |exactData| set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents the X448 private key identified by |curvePrivateKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to {{KeyType/"private"}}
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is present and if |usages|
                        contains an entry which is not
                        "`deriveKey`" or "`deriveBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is not present and if |usages| is not
                        empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`OKP`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/crv}} field of |jwk| is not
                        "`X448`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present
                        and is not equal to "`enc`" then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of JSON Web
                        Key [[JWK]], or it does not contain all of the specified |usages|
                        values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the {{JsonWebKey/d}} field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                X448 private key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"private"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                X448 public key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"public"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| is not empty
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`X448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        representing the key data provided in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |key|
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |key| be the {{CryptoKey}} to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `subjectPublicKeyInfo`
                        ASN.1 structure defined in [[RFC5280]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |algorithm| field to an
                            `AlgorithmIdentifier` ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-X448` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |subjectPublicKey| field to |keyData|.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `privateKeyInfo`
                        ASN.1 structure defined in [[RFC5208]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |version| field to `0`.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the |privateKeyAlgorithm| field to a
                            `PrivateKeyAlgorithmIdentifier` ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-X448` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |privateKey| field to the result of DER-encoding
                            a `CurvePrivateKey` ASN.1 type, as defined in Section 7 of [[RFC8410]], that represents the
                            X448 private key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                            |key|
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to
                        "`OKP`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `crv` attribute of |jwk| to
                        "`X448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/x}} attribute of |jwk| according to the
                        definition in Section 2 of [[RFC8037]].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                          of |key| is {{KeyType/"private"}}
                        </dt>
                        <dd>
                          Set the {{JsonWebKey/d}} attribute of |jwk| according to the
                          definition in Section 2 of [[RFC8037]].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If |format| is {{KeyFormat/"raw"}}:
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an <a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a> representing the X448
                        public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="ed25519">
    <h3>Ed25519</h3>
    <section id="ed25519-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`Ed25519`" algorithm identifier is used to perform signing
        and verification using the Ed25519 algorithm specified in
        [[RFC8032]].
      </p>
    </section>
    <section id="ed25519-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "`Ed25519`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>None</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>None</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="ed25519-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Sign</dt>
        <dd>
          When signing, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed25519 signing process, as specified in [[RFC8032]],
                Section 5.1.6, with |message| as |M|,
                using the Ed25519 private key associated with |key|.
              </p>
            </li>
            <li>
              <p>
                Return a new {{ArrayBuffer}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and containing the
                bytes of the signature resulting from performing
                the Ed25519 signing process.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          When verifying, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"public"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                If the key data of |key| represents an invalid point or a small-order element
                on the Elliptic Curve of Ed25519, return `false`.
              </p>
            </li>
            <li>
              <p>
                If the point R, encoded in the first half of |signature|,
                represents an invalid point or a small-order element
                on the Elliptic Curve of Ed25519, return `false`.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed25519 verification steps, as specified in [[RFC8032]],
                Section 5.1.7, on the |signature|, with |message| as |M|,
                using the Ed25519 public key associated with |key|.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a boolean with the value `true` if the signature is valid
                and the value `false` otherwise.
              </p>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains a value which is not
                one of "`sign`" or "`verify`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                Generate an Ed25519 key pair, as defined in [[RFC8032]], section 5.1.5.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new {{KeyAlgorithm}} object.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`Ed25519`".
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| to "`public`"
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |publicKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |publicKey| to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |publicKey| to be the <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a>
                of |usages| and `[ "verify" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |privateKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |privateKey| to {{KeyType/"private"}}
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |privateKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |privateKey| to |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |privateKey| to be the <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a>
                of |usages| and `[ "sign" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a new {{CryptoKeyPair}}
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/publicKey}} attribute
                of |result| to be |publicKey|.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/privateKey}} attribute
                of |result| to be |privateKey|.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting |result| to an ECMAScript Object, as
                defined by [[WebIDL]].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let |keyData| be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |spki| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `algorithm` AlgorithmIdentifier field of |spki| is
                        not equal to the `id-Ed25519`
                        object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the `algorithm`
                        AlgorithmIdentifier field of |spki| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |publicKey| be the Ed25519 public key identified by
                        the `subjectPublicKey` field of |spki|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents |publicKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`sign`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |privateKeyInfo| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                        |privateKeyInfo| is not equal to the
                        `id-Ed25519` object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                        of |privateKeyInfo| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |curvePrivateKey| be the result of performing the <a data-cite="WebCryptoAPI#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with |data| as the `privateKey` field
                        of |privateKeyInfo|, |structure| as the ASN.1
                        `CurvePrivateKey` structure specified in Section 7 of [[RFC8410]], and |exactData| set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents the Ed25519 private key identified by |curvePrivateKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to {{KeyType/"private"}}
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is present and |usages| contains
                        a value which is not
                        "`sign`", or,
                        if the {{JsonWebKey/d}} field is not present and |usages| contains
                        a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`OKP`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/crv}} field of |jwk| is not
                        "`Ed25519`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                        not "`sig`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of JSON Web
                        Key [[JWK]], or it does not contain all of the specified |usages|
                        values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the {{JsonWebKey/d}} field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                Ed25519 private key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"private"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                Ed25519 public key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"public"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        representing the key data provided in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |key|
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |key| be the {{CryptoKey}} to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `subjectPublicKeyInfo`
                        ASN.1 structure defined in [[RFC5280]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |algorithm| field to an
                            `AlgorithmIdentifier` ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-Ed25519` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |subjectPublicKey| field to |keyData|.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `privateKeyInfo`
                        ASN.1 structure defined in [[RFC5208]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |version| field to `0`.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the |privateKeyAlgorithm| field to a
                            `PrivateKeyAlgorithmIdentifier` ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-Ed25519` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |privateKey| field to the result of DER-encoding
                            a `CurvePrivateKey` ASN.1 type, as defined in Section 7 of [[RFC8410]], that represents the
                            Ed25519 private key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                            |key|
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to
                        "`OKP`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `crv` attribute of |jwk| to
                        "`Ed25519`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/x}} attribute of |jwk| according to the
                        definition in Section 2 of [[RFC8037]].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                          of |key| is {{KeyType/"private"}}
                        </dt>
                        <dd>
                          Set the {{JsonWebKey/d}} attribute of |jwk| according to the
                          definition in Section 2 of [[RFC8037]].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If |format| is {{KeyFormat/"raw"}}:
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an <a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a> representing the Ed25519
                        public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="ed448">
    <h3>Ed448</h3>
    <section id="ed448-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`Ed448`" algorithm identifier is used to perform signing
        and verification using the Ed448 algorithm specified in
        [[RFC8032]].
      </p>
    </section>
    <section id="ed448-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "`Ed448`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>{{Ed448Params}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>{{Ed448Params}}</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="ed448-params">
      <h4><dfn data-idl id="dfn-Ed448Params">Ed448Params</dfn> dictionary</h4>
      <pre class=idl>
dictionary Ed448Params : Algorithm {
  BufferSource context;
};
      </pre>
      <p>The <dfn data-idl data-dfn-for=Ed448Params id="dfn-Ed448Params-context">context</dfn> member represents the optional context data to associate with the message.</p>
    </section>
    <section id="ed448-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Sign</dt>
        <dd>
          When signing, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |context| be the <a data-cite="WebCryptoAPI#concept-contents-of-arraybuffer">contents of</a>
                the {{Ed448Params/context}} member of |normalizedAlgorithm|
                or the empty octet string if the {{Ed448Params/context}} member of
                |normalizedAlgorithm| is not present.
              </p>
            </li>
            <li>
              <p>
                If |context| has a length greater than 255 bytes,
                then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed448 signing process, as specified in [[RFC8032]],
                Section 5.2.6, with |message| as |M|
                and |context| as |C|,
                using the Ed448 private key associated with |key|.
              </p>
            </li>
            <li>
              <p>
                Return a new {{ArrayBuffer}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and containing the
                bytes of the signature resulting from performing
                the Ed448 signing process.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          When verifying, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| is not {{KeyType/"public"}}, then [= exception/throw =] an {{InvalidAccessError}}.
              </p>
            </li>
            <li>
              <p>
                Let |context| be the <a data-cite="WebCryptoAPI#concept-contents-of-arraybuffer">contents of</a>
                the {{Ed448Params/context}} member of |normalizedAlgorithm|
                or the empty octet string if the {{Ed448Params/context}} member of
                |normalizedAlgorithm| is not present.
              </p>
            </li>
            <li>
              <p>
                If |context| has a length greater than 255 bytes,
                then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the key data of |key| represents an invalid point or a small-order element
                on the Elliptic Curve of Ed448, return `false`.
              </p>
            </li>
            <li>
              <p>
                If the point R, encoded in the first half of |signature|,
                represents an invalid point or a small-order element
                on the Elliptic Curve of Ed448, return `false`.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed448 verification steps, as specified in [[RFC8032]],
                Section 5.2.7, on the |signature|, with |message| as |M|
                and |context| as |C|,
                using the Ed448 public key associated with |key|.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a boolean with the value `true` if the signature is valid
                and the value `false` otherwise.
              </p>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains a value which is not
                one of "`sign`" or "`verify`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                Generate an Ed448 key pair, as defined in [[RFC8032]], section 5.1.5.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new {{KeyAlgorithm}} object.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`Ed448`".
              </p>
            </li>
            <li>
              <p>
                Let |publicKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |publicKey| to "`public`"
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |publicKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |publicKey| to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |publicKey| to be the <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a>
                of |usages| and `[ "verify" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |privateKey| be a new {{CryptoKey}} associated with the
                [= relevant global object =]
                of `this` [[HTML]], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |privateKey| to {{KeyType/"private"}}
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |privateKey| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |privateKey| to |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |privateKey| to be the <a data-cite="WebCryptoAPI#concept-usage-intersection">usage intersection</a>
                of |usages| and `[ "sign" ]`.
              </p>
            </li>
            <li>
              <p>
                Let |result| be a new {{CryptoKeyPair}}
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/publicKey}} attribute
                of |result| to be |publicKey|.
              </p>
            </li>
            <li>
              <p>
                Set the {{CryptoKeyPair/privateKey}} attribute
                of |result| to be |privateKey|.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting |result| to an ECMAScript Object, as
                defined by [[WebIDL]].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let |keyData| be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |spki| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `algorithm` AlgorithmIdentifier field of |spki| is
                        not equal to the `id-Ed448`
                        object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the `algorithm`
                        AlgorithmIdentifier field of |spki| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |publicKey| be the Ed448 public key identified by
                        the `subjectPublicKey` field of |spki|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents |publicKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`sign`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |privateKeyInfo| be the result of running the
                        <a data-cite="WebCryptoAPI#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `algorithm` object identifier field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                        |privateKeyInfo| is not equal to the
                        `id-Ed448` object identifier defined in [[RFC8410]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the `parameters` field of the
                        `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                        of |privateKeyInfo| is present,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |curvePrivateKey| be the result of performing the <a data-cite="WebCryptoAPI#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with |data| as the `privateKey` field
                        of |privateKeyInfo|, |structure| as the ASN.1
                        `CurvePrivateKey` structure specified in Section 7 of [[RFC8410]], and |exactData| set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        that represents the Ed448 private key identified by |curvePrivateKey|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to {{KeyType/"private"}}
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/d}} field is present and |usages| contains
                        a value which is not
                        "`sign`", or,
                        if the {{JsonWebKey/d}} field is not present and |usages| contains
                        a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`OKP`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/crv}} field of |jwk| is not
                        "`Ed448`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                        not "`sig`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of JSON Web
                        Key [[JWK]], or it does not contain all of the specified |usages|
                        values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the {{JsonWebKey/d}} field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                Ed448 private key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"private"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If |jwk| does not meet the requirements of Section 2
                                of [[RFC8037]], then [= exception/throw =] a {{DataError}}.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let |key| be a new {{CryptoKey}} object that represents the
                                Ed448 public key identified by interpreting
                                |jwk| according to Section 2 of [[RFC8037]].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a>
                                internal slot of |Key| to {{KeyType/"public"}}.
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If |usages| contains a value which is not
                        "`verify`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be a new {{KeyAlgorithm}} object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{KeyAlgorithm/name}} attribute of
                        |algorithm| to "`Ed448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |key| be a new {{CryptoKey}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and
                        representing the key data provided in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| to "`public`"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a>
                        internal slot of |key| to |algorithm|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |key|
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |key| be the {{CryptoKey}} to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `subjectPublicKeyInfo`
                        ASN.1 structure defined in [[RFC5280]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |algorithm| field to an
                            `AlgorithmIdentifier` ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-Ed448` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |subjectPublicKey| field to |keyData|.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an instance of the `privateKeyInfo`
                        ASN.1 structure defined in [[RFC5208]]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the |version| field to `0`.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the |privateKeyAlgorithm| field to a
                            `PrivateKeyAlgorithmIdentifier` ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the |algorithm| object identifier to the
                                `id-Ed448` OID defined in [[RFC8410]].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the |privateKey| field to the result of DER-encoding
                            a `CurvePrivateKey` ASN.1 type, as defined in Section 7 of [[RFC8410]], that represents the
                            Ed448 private key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                            |key|
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to
                        "`OKP`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `crv` attribute of |jwk| to
                        "`Ed448`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/x}} attribute of |jwk| according to the
                        definition in Section 2 of [[RFC8037]].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                          of |key| is {{KeyType/"private"}}
                        </dt>
                        <dd>
                          Set the {{JsonWebKey/d}} attribute of |jwk| according to the
                          definition in Section 2 of [[RFC8037]].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If |format| is {{KeyFormat/"raw"}}:
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot
                        of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be an <a data-cite="WebCryptoAPI#dfn-octet-string">octet string</a>
                        representing the Ed448 public key represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                        internal slot of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be a new {{ArrayBuffer}} associated with the
                        [= relevant global object =]
                        of `this` [[HTML]], and containing
                        |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section>
    <h2>Usage Example</h2>
    <p>
      This example generates two X25519 key pairs, one for Alice and one for Bob, performs
      a key agreement between them, derives a 256-bit AES-GCM key from the result using
      HKDF with SHA-256, and encrypts and decrypts some data with it.
    </p>
    <pre class="example js" title="X25519 key agreement">
      // Generate a key pair for Alice.
      const alice_x25519_key = await crypto.subtle.generateKey('X25519', false /* extractable */, ['deriveKey']);
      const alice_private_key = alice_x25519_key.privateKey;

      // Normally, the public key would be sent by Bob to Alice in advance over some authenticated channel.
      // In this example, we'll generate another key pair and use its public key instead.
      const bob_x25519_key = await crypto.subtle.generateKey('X25519', false /* extractable */, ['deriveKey']);
      const bob_public_key = bob_x25519_key.publicKey;

      // Perform the key agreement.
      const alice_x25519_params = { name: 'X25519', public: bob_public_key };
      const alice_shared_key = await crypto.subtle.deriveKey(alice_x25519_params, alice_private_key, 'HKDF', false /* extractable */, ['deriveKey']);

      // Derive a symmetric key from the result.
      const salt = crypto.getRandomValues(new Uint8Array(32));
      const info = new TextEncoder().encode('X25519 key agreement for an AES-GCM-256 key');
      const hkdf_params = { name: 'HKDF', hash: 'SHA-256', salt, info };
      const gcm_params = { name: 'AES-GCM', length: 256 };
      const alice_symmetric_key = await crypto.subtle.deriveKey(hkdf_params, alice_shared_key, gcm_params, false /* extractable */, ['encrypt', 'decrypt']);

      // Encrypt some data with the symmetric key, and send it to Bob. The IV must be passed along as well.
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const message = new TextEncoder().encode('Hi Bob!');
      const encrypted = await crypto.subtle.encrypt({ ...gcm_params, iv }, alice_symmetric_key, message);

      // On Bob's side, Alice's public key and Bob's private key are used, instead.
      // To get the same result, Alice and Bob must agree on using the same salt and info.
      const alice_public_key = alice_x25519_key.publicKey;
      const bob_private_key = bob_x25519_key.privateKey;
      const bob_x25519_params = { name: 'X25519', public: alice_public_key };
      const bob_shared_key = await crypto.subtle.deriveKey(bob_x25519_params, bob_private_key, 'HKDF', false /* extractable */, ['deriveKey']);
      const bob_symmetric_key = await crypto.subtle.deriveKey(hkdf_params, bob_shared_key, gcm_params, false /* extractable */, ['encrypt', 'decrypt']);

      // On Bob's side, the data can be decrypted.
      const decrypted = await crypto.subtle.decrypt({ ...gcm_params, iv }, bob_symmetric_key, encrypted);
      const decrypted_message = new TextDecoder().decode(decrypted);
    </pre>
  </section>

  <section id="jwk-mapping" class="appendix informative">
    <h2>Mapping between JSON Web Key / JSON Web Algorithm</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <h3>Algorithm mappings</h3>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre class=js>
{ kty: "OKP",
  crv: "X25519" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "X25519" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "OKP",
  crv: "X448" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "X448" }
</pre>
          </td>
        </tr>
          <td>
<pre class=js>
{ kty: "OKP",
  crv: "Ed25519" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "Ed25519" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "OKP",
  crv: "Ed448" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "Ed448" }
</pre>
          </td>
        </tr>
      </tbody>
    </table>
  </section>
  <section id="spki-mapping" class="appendix informative" >
    <h2>Mapping between Algorithm and SubjectPublicKeyInfo</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting SPKI.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">Algorithm OID</th>
          <th scope="col">subjectPublicKey ASN.1 structure</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-X25519 (1.3.101.110)</td>
          <td>BIT STRING</td>
          <td>
            "`X25519`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-X448 (1.3.101.111)</td>
          <td>BIT STRING</td>
          <td>
            "`X448`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-Ed25519 (1.3.101.112)</td>
          <td>BIT STRING</td>
          <td>
            "`Ed25519`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-Ed448 (1.3.101.113)</td>
          <td>BIT STRING</td>
          <td>
            "`Ed448`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
      </tbody>
    </table>
  </section>
  <section id="pkcs8-mapping" class="appendix informative">
    <h2>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting PKCS#8 PrivateKeyInfo.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">privateKeyAlgorithm</th>
          <th scope="col">privateKey format</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-X25519 (1.3.101.110)</td>
          <td>CurvePrivateKey</td>
          <td>
            "`X25519`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-X448 (1.3.101.111)</td>
          <td>CurvePrivateKey</td>
          <td>
            "`X448`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-Ed25519 (1.3.101.112)</td>
          <td>CurvePrivateKey</td>
          <td>
            "`Ed25519`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
        <tr>
          <td>id-Ed448 (1.3.101.113)</td>
          <td>CurvePrivateKey</td>
          <td>
            "`Ed448`"
          </td>
          <td>
            [[RFC8410]]
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="conformance"></section>
</body>

</html>
