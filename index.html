<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.1.2">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
<title>Secure Curves in the Web Cryptography API</title>
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
  

<meta name="color-scheme" content="light">
<meta name="description" content="This specification defines a number of algorithms for the Web Cryptography API,
      namely X25519 and X448 [RFC7748], and Ed25519 and Ed448 [RFC8032].">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "github": "WICG/webcrypto-secure-curves",
  "editors": [
    {
      "name": "Daniel Huigens",
      "url": "mailto:daniel.huigens@proton.ch",
      "company": "Proton AG",
      "companyURL": "https://proton.me/"
    }
  ],
  "shortName": "webcrypto-secure-curves",
  "specStatus": "CG-DRAFT",
  "group": "wicg",
  "xref": [
    "WebIDL",
    "WebCryptoAPI"
  ],
  "localBiblio": {
    "SafeCurves": {
      "title": "Daniel J. Bernstein and Tanja Lange. SafeCurves: choosing safe curves for elliptic-curve cryptography",
      "href": "https://safecurves.cr.yp.to/",
      "id": "safecurves"
    }
  },
  "publishISODate": "2024-10-21T00:00:00.000Z",
  "generatedSubtitle": "Draft Community Group Report 21 October 2024"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-draft"></head>

<body class="h-entry" data-cite="WEBIDL WebIDL WebCryptoAPI"><div class="head">
    
    <h1 id="title" class="title">Secure Curves in the Web Cryptography API</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Draft Community Group Report</a>
      <time class="dt-published" datetime="2024-10-21">21 October 2024</time>
    </p>
    <dl>
      
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/webcrypto-secure-curves/">https://www.w3.org/webcrypto-secure-curves/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://wicg.github.io/webcrypto-secure-curves/">https://wicg.github.io/webcrypto-secure-curves/</a></dd>
      
      
      
      
      <dt>Editor:</dt><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:daniel.huigens@proton.ch">Daniel Huigens</a> (<a class="p-org org h-org" href="https://proton.me/">Proton AG</a>)
  </dd>
      
      
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/WICG/webcrypto-secure-curves/">GitHub WICG/webcrypto-secure-curves</a>
        (<a href="https://github.com/WICG/webcrypto-secure-curves/pulls/">pull requests</a>,
        <a href="https://github.com/WICG/webcrypto-secure-curves/issues/new/choose">new issue</a>,
        <a href="https://github.com/WICG/webcrypto-secure-curves/issues/">open issues</a>)
      </dd>
      
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/policies/#copyright">Copyright</a>
          ©
          2024
          
          the Contributors to the Secure Curves in the Web Cryptography API
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2>
    <p>
      This specification defines a number of algorithms for the <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a></cite>,
      namely X25519 and X448 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>], and Ed25519 and Ed448 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
    </p>
  </section>
  <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>
            there is a limited opt-out and other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
    <p>
      This is an unofficial proposal.
    </p>
  <p>
    <a href="https://github.com/WICG/webcrypto-secure-curves/issues/">GitHub Issues</a> are preferred for
          discussion of this specification.
        
    
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</a></li><li class="tocline"><a class="tocxref" href="#x25519"><bdi class="secno">3. </bdi>X25519</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#x25519-description"><bdi class="secno">3.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#x25519-registration"><bdi class="secno">3.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#x25519-operations"><bdi class="secno">3.3 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#x448"><bdi class="secno">4. </bdi>X448</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#x448-description"><bdi class="secno">4.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#x448-registration"><bdi class="secno">4.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#x448-operations"><bdi class="secno">4.3 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#ed25519"><bdi class="secno">5. </bdi>Ed25519</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ed25519-description"><bdi class="secno">5.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#ed25519-registration"><bdi class="secno">5.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#ed25519-operations"><bdi class="secno">5.3 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#ed448"><bdi class="secno">6. </bdi>Ed448</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ed448-description"><bdi class="secno">6.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#ed448-registration"><bdi class="secno">6.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#ed448-params"><bdi class="secno">6.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="Ed448Params" data-dfn-for=""><code>Ed448Params</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#ed448-operations"><bdi class="secno">6.4 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#usage-example"><bdi class="secno">7. </bdi>Usage Example</a></li><li class="tocline"><a class="tocxref" href="#jwk-mapping"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</a></li></ol></li><li class="tocline"><a class="tocxref" href="#spki-mapping"><bdi class="secno">B. </bdi>Mapping between Algorithm and SubjectPublicKeyInfo</a></li><li class="tocline"><a class="tocxref" href="#pkcs8-mapping"><bdi class="secno">C. </bdi>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">D. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">E. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">E.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">E.2 </bdi>Informative references</a></li></ol></li></ol></nav>
  <section id="introduction" class="informative"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      The <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a></cite> currently does not specify any "safe curves" [<cite><a class="bibref" data-link-type="biblio" href="#bib-safecurves" title="Daniel J. Bernstein and Tanja Lange. SafeCurves: choosing safe curves for elliptic-curve cryptography">SafeCurves</a></cite>].
      Among the safe curves, Curve25519 and Curve448 have gained the most traction, and
      have been specified for use in TLS 1.3, among others. This specification aims to
      expose these algorithms to the web platform.
      To this end, this specification defines a number of algorithms and operations for
      the <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a></cite>, namely key agreement using X25519 and X448 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>], and
      signing and verifying using Ed25519 and Ed448 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
    </p>
  </section>
  <section id="specification-conventions"><div class="header-wrapper"><h2 id="x2-specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</h2><a class="self-link" href="#specification-conventions" aria-label="Permalink for Section 2."></a></div>
    
    <p>
      This specification follows the <a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it <em class="rfc2119">MUST</em> implement all of the supported operations specified in this
      document, and must perform the steps to <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>] for each of the supported operations.
    </p>
  </section>

  <section id="x25519"><div class="header-wrapper"><h2 id="x3-x25519"><bdi class="secno">3. </bdi>X25519</h2><a class="self-link" href="#x25519" aria-label="Permalink for Section 3."></a></div>
    
    <section id="x25519-description" class="informative"><div class="header-wrapper"><h3 id="x3-1-description"><bdi class="secno">3.1 </bdi>Description</h3><a class="self-link" href="#x25519-description" aria-label="Permalink for Section 3.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>X25519</code>" algorithm identifier is used to perform
        key agreement using the X25519 algorithm specified in
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>].
      </p>
    </section>
    <section id="x25519-registration"><div class="header-wrapper"><h3 id="x3-2-registration"><bdi class="secno">3.2 </bdi>Registration</h3><a class="self-link" href="#x25519-registration" aria-label="Permalink for Section 3.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "<code>X25519</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td><a data-link-type="idl" data-lt="EcdhKeyDeriveParams" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdhKeyDeriveParams"><code>EcdhKeyDeriveParams</code></a></td>
            <td><a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="x25519-operations"><div class="header-wrapper"><h3 id="x3-3-operations"><bdi class="secno">3.3 </bdi>Operations</h3><a class="self-link" href="#x25519-operations" aria-label="Permalink for Section 3.3"></a></div>
      
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be the
                <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdhKeyDeriveParams-public"><code>public</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal slot of
                <var>publicKey</var> is not equal to the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> property of the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal slot of
                <var>key</var>, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>secret</var> be the result of performing the X25519 function specified in
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>] Section 5 with <var>key</var> as the X25519 private key <var>k</var>
                and the X25519 public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>publicKey</var> as the X25519 public key <var>u</var>.
              </p>
            </li>
            <li>
              <p>
                If <var>secret</var> is the all-zero value,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                This check must be performed in constant-time, as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>] Section 6.1.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>length</var> is null:</dt>
                <dd>Return <var>secret</var></dd>
                <dt>Otherwise:</dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the length of <var>secret</var> in bits is less than
                      <var>length</var>:
                    </dt>
                    <dd>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                      <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      Return an <a href="https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains an entry which is not
                "<code>deriveKey</code>" or "<code>deriveBits</code>"
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Generate an X25519 key pair, with the private key being 32 random bytes,
                and the public key being <code>X25519(a, 9)</code>,
                as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>], section 6.1.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>X25519</code>".
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> to "<code>public</code>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>publicKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>publicKey</var> to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>publicKey</var> to be the empty list.
              </p>
            </li>
            <li>
              <p>
                Let <var>privateKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>privateKey</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>privateKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>privateKey</var> to <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>privateKey</var> to be the
                <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a> of
                <var>usages</var> and <code>[ "deriveKey", "deriveBits" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a new <a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
                of <var>result</var> to be <var>publicKey</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
                of <var>result</var> to be <var>privateKey</var>.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting <var>result</var> to an ECMAScript Object, as
                defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let <var>keyData</var> be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> is not empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>spki</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                        not equal to the <code>id-X25519</code>
                        object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the <code>algorithm</code>
                        AlgorithmIdentifier field of <var>spki</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>publicKey</var> be the X25519 public key identified by
                        the <code>subjectPublicKey</code> field of <var>spki</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents <var>publicKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains an entry which is not
                        "<code>deriveKey</code>" or "<code>deriveBits</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>privateKeyInfo</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                        <var>privateKeyInfo</var> is not equal to the
                        <code>id-X25519</code> object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                        of <var>privateKeyInfo</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>curvePrivateKey</var> be the result of performing the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with <var>data</var> as the <code>privateKey</code> field
                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1
                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], and <var>exactData</var> set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents the X25519 private key identified by <var>curvePrivateKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present and if <var>usages</var>
                        contains an entry which is not
                        "<code>deriveKey</code>" or "<code>deriveBits</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is not present and if <var>usages</var> is not
                        empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>OKP</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-crv"><code>crv</code></a> field of <var>jwk</var> is not
                        "<code>X25519</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present
                        and is not equal to "<code>enc</code>" then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of JSON Web
                        Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                        values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK private key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                X25519 private key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK public key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                X25519 public key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new instance of a <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> is not empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        representing the key data provided in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>key</var>
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>key</var> be the <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>algorithm</var> field to an
                            <code>AlgorithmIdentifier</code> ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-X25519</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>version</var> field to <code>0</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKeyAlgorithm</var> field to a
                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-X25519</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKey</var> field to the result of DER-encoding
                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], that represents the
                            X25519 private key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                            <var>key</var>
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to
                        "<code>OKP</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>crv</code> attribute of <var>jwk</var> to
                        "<code>X25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-x"><code>x</code></a> attribute of <var>jwk</var> according to the
                        definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                          of <var>key</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                        </dt>
                        <dd>
                          Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> attribute of <var>jwk</var> according to the
                          definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a> representing the X25519
                        public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="x448"><div class="header-wrapper"><h2 id="x4-x448"><bdi class="secno">4. </bdi>X448</h2><a class="self-link" href="#x448" aria-label="Permalink for Section 4."></a></div>
    
    <section id="x448-description" class="informative"><div class="header-wrapper"><h3 id="x4-1-description"><bdi class="secno">4.1 </bdi>Description</h3><a class="self-link" href="#x448-description" aria-label="Permalink for Section 4.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>X448</code>" algorithm identifier is used to perform
        key agreement using the X448 algorithm specified in
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>].
      </p>
    </section>
    <section id="x448-registration"><div class="header-wrapper"><h3 id="x4-2-registration"><bdi class="secno">4.2 </bdi>Registration</h3><a class="self-link" href="#x448-registration" aria-label="Permalink for Section 4.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "<code>X448</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td><a data-link-type="idl" data-lt="EcdhKeyDeriveParams" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdhKeyDeriveParams"><code>EcdhKeyDeriveParams</code></a></td>
            <td><a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="x448-operations"><div class="header-wrapper"><h3 id="x4-3-operations"><bdi class="secno">4.3 </bdi>Operations</h3><a class="self-link" href="#x448-operations" aria-label="Permalink for Section 4.3"></a></div>
      
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be the
                <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdhKeyDeriveParams-public"><code>public</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal slot of
                <var>publicKey</var> is not equal to the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> property of the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal slot of
                <var>key</var>, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>secret</var> be the result of performing the X448 function specified in
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>] Section 5 with <var>key</var> as the X448 private key <var>k</var>
                and the X448 public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>publicKey</var> as the X448 public key <var>u</var>.
              </p>
            </li>
            <li>
              <p>
                If <var>secret</var> is the all-zero value,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                This check must be performed in constant-time, as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>] Section 6.2.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>length</var> is null:</dt>
                <dd>Return <var>secret</var></dd>
                <dt>Otherwise:</dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the length of <var>secret</var> in bits is less than
                      <var>length</var>:
                    </dt>
                    <dd>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                      <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      Return an <a href="https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains an entry which is not
                "<code>deriveKey</code>" or "<code>deriveBits</code>"
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Generate an X448 key pair, with the private key being 56 random bytes,
                and the public key being <code>X448(a, 5)</code>,
                as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7748" title="Elliptic Curves for Security">RFC7748</a></cite>], section 6.2.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>X448</code>".
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> to "<code>public</code>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>publicKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>publicKey</var> to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>publicKey</var> to be the empty list.
              </p>
            </li>
            <li>
              <p>
                Let <var>privateKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>privateKey</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>privateKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>privateKey</var> to <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>privateKey</var> to be the
                <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a> of
                <var>usages</var> and <code>[ "deriveKey", "deriveBits" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a new <a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
                of <var>result</var> to be <var>publicKey</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
                of <var>result</var> to be <var>privateKey</var>.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting <var>result</var> to an ECMAScript Object, as
                defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let <var>keyData</var> be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> is not empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>spki</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                        not equal to the <code>id-X448</code>
                        object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the <code>algorithm</code>
                        AlgorithmIdentifier field of <var>spki</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>publicKey</var> be the X448 public key identified by
                        the <code>subjectPublicKey</code> field of <var>spki</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents <var>publicKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains an entry which is not
                        "<code>deriveKey</code>" or "<code>deriveBits</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>privateKeyInfo</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                        <var>privateKeyInfo</var> is not equal to the
                        <code>id-X448</code> object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                        of <var>privateKeyInfo</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>curvePrivateKey</var> be the result of performing the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with <var>data</var> as the <code>privateKey</code> field
                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1
                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], and <var>exactData</var> set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents the X448 private key identified by <var>curvePrivateKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present and if <var>usages</var>
                        contains an entry which is not
                        "<code>deriveKey</code>" or "<code>deriveBits</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is not present and if <var>usages</var> is not
                        empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>OKP</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-crv"><code>crv</code></a> field of <var>jwk</var> is not
                        "<code>X448</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present
                        and is not equal to "<code>enc</code>" then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of JSON Web
                        Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                        values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK private key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                X448 private key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK public key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                X448 public key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new instance of a <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> is not empty
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>X448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        representing the key data provided in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>key</var>
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>key</var> be the <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>algorithm</var> field to an
                            <code>AlgorithmIdentifier</code> ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-X448</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>version</var> field to <code>0</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKeyAlgorithm</var> field to a
                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-X448</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKey</var> field to the result of DER-encoding
                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], that represents the
                            X448 private key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                            <var>key</var>
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to
                        "<code>OKP</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>crv</code> attribute of <var>jwk</var> to
                        "<code>X448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-x"><code>x</code></a> attribute of <var>jwk</var> according to the
                        definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                          of <var>key</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                        </dt>
                        <dd>
                          Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> attribute of <var>jwk</var> according to the
                          definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a> representing the X448
                        public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="ed25519"><div class="header-wrapper"><h2 id="x5-ed25519"><bdi class="secno">5. </bdi>Ed25519</h2><a class="self-link" href="#ed25519" aria-label="Permalink for Section 5."></a></div>
    
    <section id="ed25519-description" class="informative"><div class="header-wrapper"><h3 id="x5-1-description"><bdi class="secno">5.1 </bdi>Description</h3><a class="self-link" href="#ed25519-description" aria-label="Permalink for Section 5.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>Ed25519</code>" algorithm identifier is used to perform signing
        and verification using the Ed25519 algorithm specified in
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
      </p>
    </section>
    <section id="ed25519-registration"><div class="header-wrapper"><h3 id="x5-2-registration"><bdi class="secno">5.2 </bdi>Registration</h3><a class="self-link" href="#ed25519-registration" aria-label="Permalink for Section 5.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "<code>Ed25519</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td>None</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="ed25519-operations"><div class="header-wrapper"><h3 id="x5-3-operations"><bdi class="secno">5.3 </bdi>Operations</h3><a class="self-link" href="#ed25519-operations" aria-label="Permalink for Section 5.3"></a></div>
      
      <dl>
        <dt>Sign</dt>
        <dd>
          When signing, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed25519 signing process, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>],
                Section 5.1.6, with <var>message</var> as <var>M</var>,
                using the Ed25519 private key associated with <var>key</var>.
              </p>
              <div class="issue" id="issue-container-number-28"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/28"><span class="issue-number">Issue 28</span></a><span class="issue-label">: Allow creating randomized EdDSA signatures?</span></div><p class="">
                Some implementations may (wish to) generate randomized signatures
                as per <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-det-sigs-with-noise/">draft-irtf-cfrg-det-sigs-with-noise</a>
                instead of deterministic signatures as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
              </p></div>
            </li>
            <li>
              <p>
                Return a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing the
                bytes of the signature resulting from performing
                the Ed25519 signing process.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          When verifying, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the key data of <var>key</var> represents an invalid point or a small-order element
                on the Elliptic Curve of Ed25519, return <code>false</code>.
              </p>
              <div class="issue" id="issue-container-number-27"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/27"><span class="issue-number">Issue 27</span></a><span class="issue-label">: Make small-order checks in EdDSA optional?</span></div><p class="">
                Not all implementations perform this check.
              </p></div>
            </li>
            <li>
              <p>
                If the point R, encoded in the first half of <var>signature</var>,
                represents an invalid point or a small-order element
                on the Elliptic Curve of Ed25519, return <code>false</code>.
              </p>
              <div class="issue" id="issue-container-number-27-0"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/27"><span class="issue-number">Issue 27</span></a><span class="issue-label">: Make small-order checks in EdDSA optional?</span></div><p class="">
                Not all implementations perform this check.
              </p></div>
            </li>
            <li>
              <p>
                Perform the Ed25519 verification steps, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>],
                Section 5.1.7, using the cofactorless (unbatched) equation,
                <code>[S]B = R + [k]A'</code>, on the <var>signature</var>, with <var>message</var> as <var>M</var>,
                using the Ed25519 public key associated with <var>key</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid
                and the value <code>false</code> otherwise.
              </p>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains a value which is not
                one of "<code>sign</code>" or "<code>verify</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Generate an Ed25519 key pair, as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], section 5.1.5.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>Ed25519</code>".
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> to "<code>public</code>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>publicKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>publicKey</var> to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>publicKey</var> to be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a>
                of <var>usages</var> and <code>[ "verify" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>privateKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>privateKey</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>privateKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>privateKey</var> to <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>privateKey</var> to be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a>
                of <var>usages</var> and <code>[ "sign" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a new <a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
                of <var>result</var> to be <var>publicKey</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
                of <var>result</var> to be <var>privateKey</var>.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting <var>result</var> to an ECMAScript Object, as
                defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let <var>keyData</var> be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>spki</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                        not equal to the <code>id-Ed25519</code>
                        object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the <code>algorithm</code>
                        AlgorithmIdentifier field of <var>spki</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>publicKey</var> be the Ed25519 public key identified by
                        the <code>subjectPublicKey</code> field of <var>spki</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents <var>publicKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>sign</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>privateKeyInfo</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                        <var>privateKeyInfo</var> is not equal to the
                        <code>id-Ed25519</code> object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                        of <var>privateKeyInfo</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>curvePrivateKey</var> be the result of performing the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with <var>data</var> as the <code>privateKey</code> field
                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1
                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], and <var>exactData</var> set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents the Ed25519 private key identified by <var>curvePrivateKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present and <var>usages</var> contains
                        a value which is not
                        "<code>sign</code>", or,
                        if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is not present and <var>usages</var> contains
                        a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>OKP</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-crv"><code>crv</code></a> field of <var>jwk</var> is not
                        "<code>Ed25519</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present and is
                        not "<code>sig</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of JSON Web
                        Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                        values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK private key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                Ed25519 private key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK public key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                Ed25519 public key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new instance of a <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        representing the key data provided in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>key</var>
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>key</var> be the <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>algorithm</var> field to an
                            <code>AlgorithmIdentifier</code> ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-Ed25519</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>version</var> field to <code>0</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKeyAlgorithm</var> field to a
                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-Ed25519</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKey</var> field to the result of DER-encoding
                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], that represents the
                            Ed25519 private key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                            <var>key</var>
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to
                        "<code>OKP</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>crv</code> attribute of <var>jwk</var> to
                        "<code>Ed25519</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-x"><code>x</code></a> attribute of <var>jwk</var> according to the
                        definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                          of <var>key</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                        </dt>
                        <dd>
                          Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> attribute of <var>jwk</var> according to the
                          definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a> representing the Ed25519
                        public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="ed448"><div class="header-wrapper"><h2 id="x6-ed448"><bdi class="secno">6. </bdi>Ed448</h2><a class="self-link" href="#ed448" aria-label="Permalink for Section 6."></a></div>
    
    <section id="ed448-description" class="informative"><div class="header-wrapper"><h3 id="x6-1-description"><bdi class="secno">6.1 </bdi>Description</h3><a class="self-link" href="#ed448-description" aria-label="Permalink for Section 6.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>Ed448</code>" algorithm identifier is used to perform signing
        and verification using the Ed448 algorithm specified in
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
      </p>
    </section>
    <section id="ed448-registration"><div class="header-wrapper"><h3 id="x6-2-registration"><bdi class="secno">6.2 </bdi>Registration</h3><a class="self-link" href="#ed448-registration" aria-label="Permalink for Section 6.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a>
        for this algorithm is "<code>Ed448</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td><a data-link-type="idl" data-lt="Ed448Params" href="#dfn-Ed448Params" class="internalDFN" id="ref-for-dfn-Ed448Params-1"><code>Ed448Params</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td><a data-link-type="idl" data-lt="Ed448Params" href="#dfn-Ed448Params" class="internalDFN" id="ref-for-dfn-Ed448Params-2"><code>Ed448Params</code></a></td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="ed448-params"><div class="header-wrapper"><h3 id="x6-3-ed448params-dictionary"><bdi class="secno">6.3 </bdi><dfn data-idl="dictionary" id="dfn-Ed448Params" data-export="" data-dfn-type="dictionary" data-title="Ed448Params" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>Ed448Params</code></dfn> dictionary</h3><a class="self-link" href="#ed448-params" aria-label="Permalink for Section 6.3"></a></div>
      
      <pre class="idl def" id="webidl-894840244"><span class="idlHeader"><a class="self-link" href="#webidl-894840244">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-ed448params" data-title="Ed448Params">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-Ed448Params" id="ref-for-dfn-Ed448Params-3"><code>Ed448Params</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-ed448params-context" data-title="context" data-dfn-for="Ed448Params"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Ed448Params-context" id="ref-for-dfn-Ed448Params-context-1"><code>context</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-idl="field" data-dfn-for="Ed448Params" id="dfn-Ed448Params-context" data-export="" data-dfn-type="dict-member" data-title="context" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>context</code></dfn> member represents the optional context data to associate with the message.</p>
    </section>
    <section id="ed448-operations"><div class="header-wrapper"><h3 id="x6-4-operations"><bdi class="secno">6.4 </bdi>Operations</h3><a class="self-link" href="#ed448-operations" aria-label="Permalink for Section 6.4"></a></div>
      
      <dl>
        <dt>Sign</dt>
        <dd>
          When signing, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>context</var> be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer">contents of</a>
                the <a data-link-type="idl" href="#dfn-Ed448Params-context" class="internalDFN" id="ref-for-dfn-Ed448Params-context-2"><code>context</code></a> member of <var>normalizedAlgorithm</var>
                or the empty octet string if the <a data-link-type="idl" href="#dfn-Ed448Params-context" class="internalDFN" id="ref-for-dfn-Ed448Params-context-3"><code>context</code></a> member of
                <var>normalizedAlgorithm</var> is not present.
              </p>
            </li>
            <li>
              <p>
                If <var>context</var> has a length greater than 255 bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Perform the Ed448 signing process, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>],
                Section 5.2.6, with <var>message</var> as <var>M</var>
                and <var>context</var> as <var>C</var>,
                using the Ed448 private key associated with <var>key</var>.
              </p>
              <div class="issue" id="issue-container-number-28-0"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/28"><span class="issue-number">Issue 28</span></a><span class="issue-label">: Allow creating randomized EdDSA signatures?</span></div><p class="">
                Some implementations may (wish to) generate randomized signatures
                as per <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-det-sigs-with-noise/">draft-irtf-cfrg-det-sigs-with-noise</a>
                instead of deterministic signatures as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>].
              </p></div>
            </li>
            <li>
              <p>
                Return a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing the
                bytes of the signature resulting from performing
                the Ed448 signing process.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          When verifying, the following algorithm should be used:
          <ol>
            <li>
              <p>
                If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>context</var> be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer">contents of</a>
                the <a data-link-type="idl" href="#dfn-Ed448Params-context" class="internalDFN" id="ref-for-dfn-Ed448Params-context-4"><code>context</code></a> member of <var>normalizedAlgorithm</var>
                or the empty octet string if the <a data-link-type="idl" href="#dfn-Ed448Params-context" class="internalDFN" id="ref-for-dfn-Ed448Params-context-5"><code>context</code></a> member of
                <var>normalizedAlgorithm</var> is not present.
              </p>
            </li>
            <li>
              <p>
                If <var>context</var> has a length greater than 255 bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the key data of <var>key</var> represents an invalid point or a small-order element
                on the Elliptic Curve of Ed448, return <code>false</code>.
              </p>
              <div class="issue" id="issue-container-number-27-1"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/27"><span class="issue-number">Issue 27</span></a><span class="issue-label">: Make small-order checks in EdDSA optional?</span></div><p class="">
                Not all implementations perform this check.
              </p></div>
            </li>
            <li>
              <p>
                If the point R, encoded in the first half of <var>signature</var>,
                represents an invalid point or a small-order element
                on the Elliptic Curve of Ed448, return <code>false</code>.
              </p>
              <div class="issue" id="issue-container-number-27-2"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="4"><a href="https://github.com/WICG/webcrypto-secure-curves/issues/27"><span class="issue-number">Issue 27</span></a><span class="issue-label">: Make small-order checks in EdDSA optional?</span></div><p class="">
                Not all implementations perform this check.
              </p></div>
            </li>
            <li>
              <p>
                Perform the Ed448 verification steps, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>],
                Section 5.2.7, using the cofactorless (unbatched) equation,
                <code>[S]B = R + [k]A'</code>, on the <var>signature</var>, with <var>message</var> as <var>M</var>
                and <var>context</var> as <var>C</var>,
                using the Ed448 public key associated with <var>key</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid
                and the value <code>false</code> otherwise.
              </p>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains a value which is not
                one of "<code>sign</code>" or "<code>verify</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Generate an Ed448 key pair, as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], section 5.1.5.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>Ed448</code>".
              </p>
            </li>
            <li>
              <p>
                Let <var>publicKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the public key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>publicKey</var> to "<code>public</code>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>publicKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>publicKey</var> to true.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>publicKey</var> to be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a>
                of <var>usages</var> and <code>[ "verify" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>privateKey</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                representing the private key of the generated key pair.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>privateKey</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>privateKey</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>privateKey</var> to <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>privateKey</var> to be the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection">usage intersection</a>
                of <var>usages</var> and <code>[ "sign" ]</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be a new <a data-link-type="idl" data-lt="CryptoKeyPair" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
                dictionary.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
                of <var>result</var> to be <var>publicKey</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
                of <var>result</var> to be <var>privateKey</var>.
              </p>
            </li>
            <li>
              <p>
                Return the result of converting <var>result</var> to an ECMAScript Object, as
                defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
              </p>
            </li>
          </ol>
        </dd>

        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let <var>keyData</var> be the key data to be imported.</p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>spki</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                        not equal to the <code>id-Ed448</code>
                        object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the <code>algorithm</code>
                        AlgorithmIdentifier field of <var>spki</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>publicKey</var> be the Ed448 public key identified by
                        the <code>subjectPublicKey</code> field of <var>spki</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents <var>publicKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>sign</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>privateKeyInfo</var> be the result of running the
                        <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                        algorithm over <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurs while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>algorithm</code> object identifier field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                        <var>privateKeyInfo</var> is not equal to the
                        <code>id-Ed448</code> object identifier defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <code>parameters</code> field of the
                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                        of <var>privateKeyInfo</var> is present,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>curvePrivateKey</var> be the result of performing the <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                        algorithm, with <var>data</var> as the <code>privateKey</code> field
                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1
                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], and <var>exactData</var> set to true.
                      </p>
                    </li>
                    <li>
                      <p>
                        If an error occurred while parsing,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        that represents the Ed448 private key identified by <var>curvePrivateKey</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present and <var>usages</var> contains
                        a value which is not
                        "<code>sign</code>", or,
                        if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is not present and <var>usages</var> contains
                        a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>OKP</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-crv"><code>crv</code></a> field of <var>jwk</var> is not
                        "<code>Ed448</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present and is
                        not "<code>sig</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of JSON Web
                        Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                        values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> field is present:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK private key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                Ed448 private key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <ol>
                            <li>
                              <p>
                                If <var>jwk</var> does not meet the requirements of
                                the JWK public key format described in Section 2
                                of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>], then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                                Ed448 public key identified by interpreting
                                <var>jwk</var> according to Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                              </p>
                            </li>
                            <li>
                              <p>
                                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a>
                                internal slot of <var>Key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-public"><code>public</code></a>".
                              </p>
                            </li>
                          </ol>
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new instance of a <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If <var>usages</var> contains a value which is not
                        "<code>verify</code>"
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                        <var>algorithm</var> to "<code>Ed448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and
                        representing the key data provided in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> to "<code>public</code>"
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a>
                        internal slot of <var>key</var> to <var>algorithm</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>key</var>
              </p>
            </li>
          </ol>
        </dd>

        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>key</var> be the <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
                exported.
              </p>
            </li>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-spki"><code>spki</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>algorithm</var> field to an
                            <code>AlgorithmIdentifier</code> ASN.1 type with the following
                            properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-Ed448</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-pkcs8"><code>pkcs8</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>
                        ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                        with the following properties:
                      </p>
                      <ul>
                        <li>
                          <p>
                            Set the <var>version</var> field to <code>0</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKeyAlgorithm</var> field to a
                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                            following properties:
                          </p>
                          <ul>
                            <li>
                              <p>
                                Set the <var>algorithm</var> object identifier to the
                                <code>id-Ed448</code> OID defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>].
                              </p>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>
                            Set the <var>privateKey</var> field to the result of DER-encoding
                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>], that represents the
                            Ed448 private key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                            <var>key</var>
                          </p>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to
                        "<code>OKP</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>crv</code> attribute of <var>jwk</var> to
                        "<code>Ed448</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-x"><code>x</code></a> attribute of <var>jwk</var> according to the
                        definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                          of <var>key</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-private"><code>private</code></a>"
                        </dt>
                        <dd>
                          Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-d"><code>d</code></a> attribute of <var>jwk</var> according to the
                          definition in Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8037" title="CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)">RFC8037</a></cite>].
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>
                  If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":
                </dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        If the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot
                        of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="InvalidAccessError" data-type="exception" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be an <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string">octet string</a>
                        representing the Ed448 public key represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                        internal slot of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be a new <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> associated with the
                        <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>
                        of <code>this</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], and containing
                        <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="usage-example"><div class="header-wrapper"><h2 id="x7-usage-example"><bdi class="secno">7. </bdi>Usage Example</h2><a class="self-link" href="#usage-example" aria-label="Permalink for Section 7."></a></div>
    
    <p>
      This example generates two X25519 key pairs, one for Alice and one for Bob, performs
      a key agreement between them, derives a 256-bit AES-GCM key from the result using
      HKDF with SHA-256, and encrypts and decrypts some data with it.
    </p>
    <div class="example" id="example-x25519-key-agreement">
        <div class="marker">
    <a class="self-link" href="#example-x25519-key-agreement">Example<bdi> 1</bdi></a><span class="example-title">: X25519 key agreement</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-comment">// Generate a key pair for Alice.</span>
<span class="hljs-keyword">const</span> alice_x25519_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">generateKey</span>(<span class="hljs-string">'X25519'</span>, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'deriveKey'</span>]);
<span class="hljs-keyword">const</span> alice_private_key = alice_x25519_key.<span class="hljs-property">privateKey</span>;

<span class="hljs-comment">// Normally, the public key would be sent by Bob to Alice in advance over some authenticated channel.</span>
<span class="hljs-comment">// In this example, we'll generate another key pair and use its public key instead.</span>
<span class="hljs-keyword">const</span> bob_x25519_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">generateKey</span>(<span class="hljs-string">'X25519'</span>, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'deriveKey'</span>]);
<span class="hljs-keyword">const</span> bob_public_key = bob_x25519_key.<span class="hljs-property">publicKey</span>;

<span class="hljs-comment">// Perform the key agreement.</span>
<span class="hljs-keyword">const</span> alice_x25519_params = { <span class="hljs-attr">name</span>: <span class="hljs-string">'X25519'</span>, <span class="hljs-attr">public</span>: bob_public_key };
<span class="hljs-keyword">const</span> alice_shared_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(alice_x25519_params, alice_private_key, <span class="hljs-string">'HKDF'</span>, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'deriveKey'</span>]);

<span class="hljs-comment">// Derive a symmetric key from the result.</span>
<span class="hljs-keyword">const</span> salt = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">32</span>));
<span class="hljs-keyword">const</span> info = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(<span class="hljs-string">'X25519 key agreement for an AES-GCM-256 key'</span>);
<span class="hljs-keyword">const</span> hkdf_params = { <span class="hljs-attr">name</span>: <span class="hljs-string">'HKDF'</span>, <span class="hljs-attr">hash</span>: <span class="hljs-string">'SHA-256'</span>, salt, info };
<span class="hljs-keyword">const</span> gcm_params = { <span class="hljs-attr">name</span>: <span class="hljs-string">'AES-GCM'</span>, <span class="hljs-attr">length</span>: <span class="hljs-number">256</span> };
<span class="hljs-keyword">const</span> alice_symmetric_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(hkdf_params, alice_shared_key, gcm_params, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'encrypt'</span>, <span class="hljs-string">'decrypt'</span>]);

<span class="hljs-comment">// Encrypt some data with the symmetric key, and send it to Bob. The IV must be passed along as well.</span>
<span class="hljs-keyword">const</span> iv = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">12</span>));
<span class="hljs-keyword">const</span> message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(<span class="hljs-string">'Hi Bob!'</span>);
<span class="hljs-keyword">const</span> encrypted = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">encrypt</span>({ ...gcm_params, iv }, alice_symmetric_key, message);

<span class="hljs-comment">// On Bob's side, Alice's public key and Bob's private key are used, instead.</span>
<span class="hljs-comment">// To get the same result, Alice and Bob must agree on using the same salt and info.</span>
<span class="hljs-keyword">const</span> alice_public_key = alice_x25519_key.<span class="hljs-property">publicKey</span>;
<span class="hljs-keyword">const</span> bob_private_key = bob_x25519_key.<span class="hljs-property">privateKey</span>;
<span class="hljs-keyword">const</span> bob_x25519_params = { <span class="hljs-attr">name</span>: <span class="hljs-string">'X25519'</span>, <span class="hljs-attr">public</span>: alice_public_key };
<span class="hljs-keyword">const</span> bob_shared_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(bob_x25519_params, bob_private_key, <span class="hljs-string">'HKDF'</span>, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'deriveKey'</span>]);
<span class="hljs-keyword">const</span> bob_symmetric_key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(hkdf_params, bob_shared_key, gcm_params, <span class="hljs-literal">false</span> <span class="hljs-comment">/* extractable */</span>, [<span class="hljs-string">'encrypt'</span>, <span class="hljs-string">'decrypt'</span>]);

<span class="hljs-comment">// On Bob's side, the data can be decrypted.</span>
<span class="hljs-keyword">const</span> decrypted = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">decrypt</span>({ ...gcm_params, iv }, bob_symmetric_key, encrypted);
<span class="hljs-keyword">const</span> decrypted_message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>().<span class="hljs-title function_">decode</span>(decrypted);</code></pre>
      </div>
  </section>

  <section id="jwk-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="a-mapping-between-json-web-key-json-web-algorithm"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</h2><a class="self-link" href="#jwk-mapping" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <section id="algorithm-mappings"><div class="header-wrapper"><h3 id="a-1-algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</h3><a class="self-link" href="#algorithm-mappings" aria-label="Permalink for Appendix A.1"></a></div>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"OKP"</span>,
  <span class="hljs-attr">crv</span>: <span class="hljs-string">"X25519"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"X25519"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"OKP"</span>,
  <span class="hljs-attr">crv</span>: <span class="hljs-string">"X448"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"X448"</span> }</code></pre>
          </td>
        </tr>
          <tr><td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"OKP"</span>,
  <span class="hljs-attr">crv</span>: <span class="hljs-string">"Ed25519"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"Ed25519"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"OKP"</span>,
  <span class="hljs-attr">crv</span>: <span class="hljs-string">"Ed448"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"Ed448"</span> }</code></pre>
          </td>
        </tr>
      </tbody>
    </table>
  </section></section>
  <section id="spki-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="b-mapping-between-algorithm-and-subjectpublickeyinfo"><bdi class="secno">B. </bdi>Mapping between Algorithm and SubjectPublicKeyInfo</h2><a class="self-link" href="#spki-mapping" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting SPKI.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">Algorithm OID</th>
          <th scope="col">subjectPublicKey ASN.1 structure</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-X25519 (1.3.101.110)</td>
          <td>BIT STRING</td>
          <td>
            "<code>X25519</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-X448 (1.3.101.111)</td>
          <td>BIT STRING</td>
          <td>
            "<code>X448</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-Ed25519 (1.3.101.112)</td>
          <td>BIT STRING</td>
          <td>
            "<code>Ed25519</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-Ed448 (1.3.101.113)</td>
          <td>BIT STRING</td>
          <td>
            "<code>Ed448</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
      </tbody>
    </table>
  </section>
  <section id="pkcs8-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="c-mapping-between-algorithm-and-pkcs-8-privatekeyinfo"><bdi class="secno">C. </bdi>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</h2><a class="self-link" href="#pkcs8-mapping" aria-label="Permalink for Appendix C."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting PKCS#8 PrivateKeyInfo.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">privateKeyAlgorithm</th>
          <th scope="col">privateKey format</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-X25519 (1.3.101.110)</td>
          <td>CurvePrivateKey</td>
          <td>
            "<code>X25519</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-X448 (1.3.101.111)</td>
          <td>CurvePrivateKey</td>
          <td>
            "<code>X448</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-Ed25519 (1.3.101.112)</td>
          <td>CurvePrivateKey</td>
          <td>
            "<code>Ed25519</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-Ed448 (1.3.101.113)</td>
          <td>CurvePrivateKey</td>
          <td>
            "<code>Ed448</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8410" title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">RFC8410</a></cite>]
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="conformance"><div class="header-wrapper"><h2 id="d-conformance"><bdi class="secno">D. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section D."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="e-references"><bdi class="secno">E. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix E."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="e-1-normative-references"><bdi class="secno">E.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix E.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-html">[HTML]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Dominic Farolino; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-jwk">[JWK]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc5208">[RFC5208]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5208"><cite>Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2</cite></a>. B. Kaliski.  IETF. May 2008. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc5208">https://www.rfc-editor.org/rfc/rfc5208</a>
    </dd><dt id="bib-rfc5280">[RFC5280]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5280"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. D. Cooper; S. Santesson; S. Farrell; S. Boeyen; R. Housley; W. Polk.  IETF. May 2008. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>
    </dd><dt id="bib-rfc7748">[RFC7748]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7748"><cite>Elliptic Curves for Security</cite></a>. A. Langley; M. Hamburg; S. Turner.  IETF. January 2016. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>
    </dd><dt id="bib-rfc8032">[RFC8032]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8032"><cite>Edwards-Curve Digital Signature Algorithm (EdDSA)</cite></a>. S. Josefsson; I. Liusvaara.  IETF. January 2017. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>
    </dd><dt id="bib-rfc8037">[RFC8037]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8037"><cite>CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)</cite></a>. I. Liusvaara.  IETF. January 2017. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8037">https://www.rfc-editor.org/rfc/rfc8037</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8410">[RFC8410]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8410"><cite>Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure</cite></a>. S. Josefsson; J. Schaad.  IETF. August 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8410">https://www.rfc-editor.org/rfc/rfc8410</a>
    </dd><dt id="bib-webcryptoapi">[WebCryptoAPI]</dt><dd>
      <a href="https://www.w3.org/TR/WebCryptoAPI/"><cite>Web Cryptography API</cite></a>. Mark Watson.  W3C. 26 January 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/WebCryptoAPI/">https://www.w3.org/TR/WebCryptoAPI/</a>
    </dd><dt id="bib-webidl">[WebIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="e-2-informative-references"><bdi class="secno">E.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix E.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-safecurves">[SafeCurves]</dt><dd>
      <a href="https://safecurves.cr.yp.to/"><cite>Daniel J. Bernstein and Tanja Lange. SafeCurves: choosing safe curves for elliptic-curve cryptography</cite></a>. URL: <a href="https://safecurves.cr.yp.to/">https://safecurves.cr.yp.to/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Ed448Params" aria-label="Links in this document to definition: Ed448Params">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Ed448Params" aria-label="Permalink for definition: Ed448Params. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-894840244">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Ed448Params-1" title="§ 6.2 Registration">§ 6.2 Registration</a> <a href="#ref-for-dfn-Ed448Params-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-Ed448Params-3" title="§ 6.3 Ed448Params dictionary">§ 6.3 Ed448Params dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Ed448Params-context" aria-label="Links in this document to definition: context">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Ed448Params-context" aria-label="Permalink for definition: context. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-894840244">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Ed448Params-context-1" title="§ 6.3 Ed448Params dictionary">§ 6.3 Ed448Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Ed448Params-context-2" title="§ 6.4 Operations">§ 6.4 Operations</a> <a href="#ref-for-dfn-Ed448Params-context-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-Ed448Params-context-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-Ed448Params-context-5" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>